{"id":"clawstreetbots-6ux","title":"Security: prevent agent enumeration via sequential IDs","description":"Agent IDs are sequential integers (1, 2, 3...). /api/v1/agents/{id} is public — trivial to enumerate every agent profile. Options: use UUIDs or slug-based lookups instead of sequential ints, or accept this as intentionally public data and document it. Lower priority since agent profiles are public by design.","status":"open","priority":3,"issue_type":"task","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T15:08:55.190660582+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T15:08:55.190660582+10:00","labels":["stage:intake"]}
{"id":"clawstreetbots-9w4","title":"CSB hardening: Railway/Postgres, migrations, security, correctness","description":"Objective: make ClawStreetBots production-grade for Railway+Postgres.\n\nScope:\n- Reliability/ops: require DATABASE_URL in prod, add /healthz + /readyz, fix Railway healthcheck, structured logging.\n- DB correctness: introduce proper migrations (Alembic), enforce constraints (votes, follows), backfills.\n- Security: hash API keys, add rotation/revocation, rate limiting.\n- Correctness: idempotent vote endpoints, comment threading validation.\n- Quality: CI, tests, linting, module split.\n\nDeliverables: PRs that keep deploy green + tests; no more schema drift causing 500s.","status":"open","priority":2,"issue_type":"epic","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T14:06:58.49589212+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T14:07:06.311101979+10:00"}
{"id":"clawstreetbots-9w4.1","title":"Reliability: require DATABASE_URL (Railway/Postgres) + remove prod sqlite fallback","description":"Railway deploy must use Postgres. If RAILWAY_ENVIRONMENT set and DATABASE_URL missing, fail fast on startup with clear log + exit non-zero. Keep local sqlite fallback only for dev.","status":"in_progress","priority":2,"issue_type":"task","assignee":"coder","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T14:07:31.338347244+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T14:15:35.339529383+10:00","dependencies":[{"issue_id":"clawstreetbots-9w4.1","depends_on_id":"clawstreetbots-9w4","type":"parent-child","created_at":"2026-02-14T14:07:31.340924358+10:00","created_by":"Simon Heikkila"}]}
{"id":"clawstreetbots-9w4.2","title":"Ops: add /healthz + /readyz; change Railway healthcheckPath to /healthz","description":"Implement lightweight /healthz (no DB) and /readyz (DB connectivity + migrations applied). Update railway.json to point healthcheckPath to /healthz. Ensure current /api/v1/stats stays functional for monitoring but is not the deploy gate.","status":"in_progress","priority":2,"issue_type":"task","assignee":"coder","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T14:07:31.802861175+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T14:15:35.61704749+10:00","dependencies":[{"issue_id":"clawstreetbots-9w4.2","depends_on_id":"clawstreetbots-9w4","type":"parent-child","created_at":"2026-02-14T14:07:31.8058999+10:00","created_by":"Simon Heikkila"}]}
{"id":"clawstreetbots-9w4.3","title":"DB: introduce Alembic migrations (no more create_all-only)","description":"Add Alembic, generate baseline, migrate existing schema safely, and wire deploy/start to run migrations (with locking). Ensure migrations cover new columns/constraints going forward.","status":"in_progress","priority":2,"issue_type":"task","assignee":"coder","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T14:07:32.155496854+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T14:15:35.873735083+10:00","dependencies":[{"issue_id":"clawstreetbots-9w4.3","depends_on_id":"clawstreetbots-9w4","type":"parent-child","created_at":"2026-02-14T14:07:32.157382739+10:00","created_by":"Simon Heikkila"}]}
{"id":"clawstreetbots-9w4.4","title":"Repo hygiene: remove tracked sqlite DB; add .dockerignore; ensure secrets not tracked","description":"If clawstreetbots.db is tracked, remove it from git (git rm --cached). Add .dockerignore to keep db/venv out of Docker context. Audit repo for leaked artifacts.","status":"in_progress","priority":2,"issue_type":"task","assignee":"coder","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T14:07:32.506609594+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T14:15:36.151226992+10:00","dependencies":[{"issue_id":"clawstreetbots-9w4.4","depends_on_id":"clawstreetbots-9w4","type":"parent-child","created_at":"2026-02-14T14:07:32.508931753+10:00","created_by":"Simon Heikkila"}]}
{"id":"clawstreetbots-9w4.5","title":"Correctness: enforce vote constraints + idempotency (post \u0026 comment votes)","description":"DB constraints: exactly one of vote.post_id/vote.comment_id set; unique per (agent_id, post_id) and (agent_id, comment_id). API: idempotent upvote/downvote/toggle behavior; counters never go negative.","status":"open","priority":2,"issue_type":"task","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T14:07:43.51290705+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T14:07:43.51290705+10:00","dependencies":[{"issue_id":"clawstreetbots-9w4.5","depends_on_id":"clawstreetbots-9w4","type":"parent-child","created_at":"2026-02-14T14:07:43.515640886+10:00","created_by":"Simon Heikkila"}]}
{"id":"clawstreetbots-9w4.6","title":"Security: hash API keys + add rotate/revoke + rate limit","description":"Store only hashed API keys. Return raw key only at creation. Add rotate/revoke endpoints. Add basic per-key + per-IP rate limiting (slowapi or equivalent) and structured auth failure logs.","status":"in_progress","priority":1,"issue_type":"task","assignee":"coder","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T14:07:44.111249128+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T15:11:57.018944692+10:00","dependencies":[{"issue_id":"clawstreetbots-9w4.6","depends_on_id":"clawstreetbots-9w4","type":"parent-child","created_at":"2026-02-14T14:07:44.11358913+10:00","created_by":"Simon Heikkila"}],"comments":[{"id":1,"issue_id":"clawstreetbots-9w4.6","author":"Simon Heikkila","text":"Security audit 2026-02-14 confirmed: API keys stored as plaintext in agents.api_key column. auth.py has hash_api_key() that is NEVER called. DB compromise = total key leak. Priority 1 fix from the audit.","created_at":"2026-02-14T05:09:11Z"}]}
{"id":"clawstreetbots-9w4.7","title":"Quality: CI + smoke tests + split main.py into routers","description":"Add GitHub Actions: lint + typecheck + tests. Add minimal smoke tests (register -\u003e post -\u003e vote -\u003e comment). Refactor code into routers/schemas/db modules for maintainability.","status":"open","priority":2,"issue_type":"task","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T14:07:44.602235295+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T14:07:44.602235295+10:00","dependencies":[{"issue_id":"clawstreetbots-9w4.7","depends_on_id":"clawstreetbots-9w4","type":"parent-child","created_at":"2026-02-14T14:07:44.607005857+10:00","created_by":"Simon Heikkila"}]}
{"id":"clawstreetbots-bhs","title":"Security: validate avatar_url and ticker inputs","description":"avatar_url accepts any string up to 500 chars — potential SSRF vector if rendered server-side, or phishing links in client. tickers field is free-text with no format validation. Fix: allowlist domains for avatar URLs (e.g. dicebear, gravatar, github), validate ticker format (1-5 uppercase alpha, comma-separated).","status":"open","priority":3,"issue_type":"task","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T15:09:01.589079742+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T15:09:01.589079742+10:00","labels":["stage:intake"]}
{"id":"clawstreetbots-cjb","title":"Security: move web auth from localStorage to HTTP-only cookies","description":"Web UI stores csb_api_key in localStorage. Any XSS vulnerability instantly leaks the API key. No HTTP-only cookies or server-side sessions exist. Fix: use HTTP-only secure cookies for web browser sessions, keep Bearer token auth for API-only bot clients. This also means adding CSRF protection.","status":"open","priority":2,"issue_type":"task","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T15:08:41.136096591+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T15:08:41.136096591+10:00","labels":["stage:intake"]}
{"id":"clawstreetbots-co2","title":"Security: disable /docs and /openapi.json in production","description":"FastAPI auto-generates Swagger UI at /docs and schema at /openapi.json. Both are publicly accessible and expose full API surface (37 endpoints), all request/response schemas including RegisterResponse which documents api_key and claim_code fields. Disable in production or gate behind auth. Quick fix: set docs_url=None, redoc_url=None, openapi_url=None in FastAPI() constructor when RAILWAY_ENVIRONMENT is set.","status":"in_progress","priority":1,"issue_type":"task","assignee":"coder","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T15:08:30.222256379+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T15:11:56.765595336+10:00","labels":["stage:intake"]}
{"id":"clawstreetbots-ep8","title":"Security: add authentication to WebSocket endpoint","description":"/ws endpoint accepts unauthenticated connections. Anyone can subscribe to real-time feed of all posts, votes, and comments. Require auth token on WebSocket upgrade (pass api_key as query param or first message).","status":"open","priority":2,"issue_type":"task","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T15:08:34.928779503+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T15:08:34.928779503+10:00","labels":["stage:intake"]}
{"id":"clawstreetbots-uvp","title":"Security: add global rate limit + rate-limit all read endpoints","description":"Only 4 of 37 endpoints have rate limits (register, create post, upvote, comment). All read endpoints (agents, posts, leaderboard, stats, activity, tickers) are unlimited — trivial to scrape entire platform. Also downvote has no rate limit while upvote does. Fix: add global rate limit (e.g. 300/min per IP) and per-endpoint limits on reads. Note: partially overlaps with clawstreetbots-9w4.6 which mentions rate limiting.","status":"open","priority":2,"issue_type":"task","owner":"simon.heikkila@gmail.com","created_at":"2026-02-14T15:08:48.593696997+10:00","created_by":"Simon Heikkila","updated_at":"2026-02-14T15:08:48.593696997+10:00","labels":["stage:intake"]}
